[
  {
    "path": "projects/",
    "title": "Willamette Fish Passage Time Series",
    "description": {},
    "author": [
      {
        "name": "Patrick Pelegri-O'Day",
        "url": {}
      }
    ],
    "date": "2022-03-13",
    "categories": [],
    "contents": "\n\n\nhide\n\nknitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)\n\nlibrary(here)\nlibrary(tidyverse)\nlibrary(tsibble)\nlibrary(feasts)\nlibrary(slider)\nlibrary(lubridate)\n\n\n\nOverall\nThis report visualizes fish passage data at Willamette Falls collected by the University of Washington’s Columbia Basin Research initiative from 2001 to 2010. Data collection at this site is managed by a combination of federal, state, and tribal agencies. The tabs below visualize these fish passage data through a time series plot of daily counts, a season plot, and annual counts by species.\nSalmon in Katmai National Park, Alaska. From World AtlasData citation: University of Washington, Columbia Basin Research. 2010. DART Adult Passage Graphics & Text. http://www.cbr.washington.edu/dart/query/adult_graph_text.\nArrow indicates location of Willamette Falls. From Clemens et al. 2017: https://doi.org/10.1007/s10750-017-3096-4\n\nhide\n\n# Read in the data and perform initial wrangling\n\nfish_raw <- read_csv(here('_projects', 'data', 'willamette_fish_passage.csv'))\n\nfish_ts <- fish_raw %>% \n  janitor::clean_names() %>% \n  mutate(date = mdy(date)) %>% \n  as_tsibble(key = NULL, index = date) %>%   \n  select(coho, jack_coho, steelhead) %>% \n  replace_na(list(coho = 0, jack_coho = 0, steelhead = 0)) %>%  # replace NA values with 0\n  pivot_longer( # so that we can visualize them all on the same panel\n    cols = coho:steelhead,\n    names_to = \"species\",\n    values_to = 'count'\n  ) %>% \n  mutate(species = case_when(\n    species == 'coho' ~ \"Coho\",\n    species == 'jack_coho' ~ \"Jack Coho\",\n    species == 'steelhead' ~ \"Steelhead\"\n  ))\n\nfish_ts[fish_ts < 0] <- 0 # replace negative values to 0 because negative counts don't make sense and time series has an issue if there are missing values.\n\n\n\nOriginal time series\n\n\nhide\n\n# Time series graph\n\nggplot(data = fish_ts, aes(x = date, y = count)) +\n  geom_line(aes(color = species)) +\n  labs(x = \"Date\",\n       y = \"Count\",\n       color = \"Species\") +\n  scale_color_manual(values = c('dodgerblue3', 'firebrick4', 'cornsilk4')) +\n  theme_minimal()\n\n\n\n\nFigure 1. Time series plot of Coho, Jack Coho, and Steelhead counts at the Willamette Falls fish passage from 2001-2010.\nFigure 1 takeaways\nThe Steelhead run has been the most consistent of the three species observed, and the Steelhead run occurs at a different time of year than the Coho and Jack Coho.\nThe Coho run has been inconsistent from year to year but in large years has had the highest counts of the three species. The Jack Coho had the smallest runs of the three species on average.\nThe Jack Coho and Coho runs appear to occur at the same time of year.\nSeason plots\n\n\nhide\n\n# Plot season plot\n\ngg_season(data = fish_ts, y = count) +\n  scale_color_viridis_c(breaks = c(1, 3, 5, 7, 9), \n                        labels = c(2001, 2003, 2005, 2007, 2009)) +\n  facet_wrap(~species) +\n  labs(y = \"Count\", x = \"Date\", color = \"Year\")\n\n\n\n\nFigure 2. Monthly trends in counts of Steelhead, Coho, and Jack Coho at Willamette Falls fish passage from 2001 to 2010\nFigure 2 takeaways\nCoho and Jack Coho have a distinct peak in counts around October. Counts were closer to 0 the rest of the year.\nSteelhead counts are more evenly distributed throughout the year than Coho and Jack Coho. Steelhead counts peak around June and are lowest from roughly September to November.\nAnnual counts by species\n\n\nhide\n\n# Prepare data for plot\n\nfish_counts_df <- fish_raw %>% \n  \n  # This code repeats what we did to create fish_ts without making it a ts, except observations with negative counts are removed instead of replaced with 0\n  janitor::clean_names() %>% \n  mutate(date = mdy(date)) %>% \n  select(coho, jack_coho, steelhead, date) %>% \n  replace_na(list(coho = 0, jack_coho = 0, steelhead = 0)) %>%\n  filter(coho >= 0, jack_coho >= 0, steelhead >=0) %>% # remove observations with negative counts\n  pivot_longer( \n    cols = coho:steelhead,\n    names_to = \"species\",\n    values_to = 'count'\n  ) %>% \n  mutate(species = case_when(\n    species == 'coho' ~ \"Coho\",\n    species == 'jack_coho' ~ \"Jack Coho\",\n    species == 'steelhead' ~ \"Steelhead\"\n  )) %>% \n  \n  # This code is for creating counts by year\n  mutate(year = year(date)) %>% \n  select(-date) %>% \n  group_by(year, species) %>% \n  summarize(annual_count = sum(count))\n\n\n\n\n\nhide\n\n# Plot annual counts by species\n\nggplot(fish_counts_df) +\n  geom_line(aes(x = year, y = annual_count, color = species), size = 0.7) +\n  scale_color_manual(values = c('dodgerblue3', 'firebrick4', 'cornsilk4')) +\n  theme_minimal() + \n  scale_x_continuous(breaks = scales::pretty_breaks(5)) +\n  labs(x = \"Year\", y = 'Count', color = 'Species')\n\n\n\n\nFigure 3. Annual counts of Coho, Jack Coho, and Steelhead at Willamette Falls fish passage from 2001 to 2010\nFigure 3 takeaways\nSteelhead annual counts were the highest every year except 2009, but had a general downward trend.\nCoho counts stayed relatively stable with some cyclical variation from 2001 to 2008, then roughly quadrupled in magnitude in 2009 and 2010.\nJack Coho counts were the smallest of the three species and stayed relatively consistent from 2001 to 2010.\n\n\n\n",
    "preview": "projects/fish_passage_ts_files/figure-html5/unnamed-chunk-2-1.png",
    "last_modified": "2022-03-13T12:32:45-07:00",
    "input_file": {}
  }
]
